SUPABASE AUTHENTICATION ERROR TROUBLESHOOTING GUIDE
=================================================

ERROR ANALYSIS:
---------------

Based on your error messages:
1. "Failed to load resource: the server responded with a status of 401 ()"
2. "Profile insertion error (not critical)"
3. "Failed to load resource: the server responded with a status of 400 ()"

These errors indicate authentication issues with your Supabase setup.

COMMON CAUSES AND SOLUTIONS:
---------------------------

1. MISSING ENVIRONMENT VARIABLES
-------------------------------
Symptoms:
- 401 Unauthorized errors
- "No API key found in request" messages
- Profile insertion failures

Solution:
Ensure these environment variables are set in your deployment platform (Render):
VITE_SUPABASE_URL=https://oixtcofqjffaadkzrfrr.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9peHRjb2ZxamZmYWFka3pyZnJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyNjE2MjksImV4cCI6MjA4MDgzNzYyOX0.bFbbuCtQ1th_M4es5ff53qpx0jmJKlZ7j2BiOLCF2oM

2. INCORRECT SUPABASE PROJECT SETTINGS
-------------------------------------
Symptoms:
- 400 Bad Request on authentication endpoints
- Signup/signin failures

Solution:
In your Supabase dashboard:
- Go to Authentication > Settings
- Ensure "Enable email signup" is turned ON
- Add your deployed URL to "Additional URLs" if needed

3. DATABASE SCHEMA ISSUES
-------------------------
Symptoms:
- Profile insertion errors
- Data access failures

Solution:
Ensure all required tables exist with proper RLS policies:
- profiles
- home_notes
- recipes
- shopping_lists
- shopping_items
- expenses
- chat_history

4. CORS ISSUES
--------------
Symptoms:
- Intermittent authentication failures
- Requests failing in browser but working with direct API calls

Solution:
- Check that your site URL is properly configured in Supabase auth settings
- Ensure your deployed URL is in the "Additional URLs" list

DEBUGGING STEPS:
----------------

1. Visit /diagnostics on your deployed site
2. Check if environment variables are properly loaded
3. Check the auth status displayed
4. Look at browser console for detailed error messages
5. Check Network tab to see request/response details

ADDITIONAL TIPS:
----------------

1. After setting environment variables, redeploy your application
2. Clear browser cache and try in an incognito window
3. Check that your Supabase project region matches your expectations
4. Make sure you're not using any ad blockers that might interfere with requests

If issues persist after trying these solutions:
1. Check Render logs for any server-side errors
2. Verify that your Supabase project is not paused or over its usage limits
3. Try creating a test user directly in the Supabase auth dashboard to verify the auth system is working